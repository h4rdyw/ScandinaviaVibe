{% comment %}theme-check-disable{% endcomment %}

<section class="container py-4">
  {% paginate collection.products by 4 %}
  
    <h1 class="text-center">{{ collection.title }}</h1>
 
  <div class="row">

    <div class="row row-cols-md-2">
      <div class="col">
        <div class="clearfix filter">
          <p>Sort by :</p>
          <select name="sorting" id="sort_by" class="form-select form-select-sm w-auto">
            {% for option in collection.sort_options %}
              <option value="{{ option.value }}"
              {% if option.value == collection.sort_by %}
                selected="selected"
              {% endif %}
            >{{ option.name }}</option>
            {% endfor %}
          </select>
        </div>  
      </div>
      
      <div class="col">
        <div class="clearfix filter">
          {% if collection.handle == 'collection' %}
            <p>Browse type:</p>
            <select name="filter_type" id="filter_by_type"  class="form-select form-select-sm w-auto">
            <option value="">All</option>
            {% for product_type in collection.all_types %}
            {% if current_tags contains product_type %}
            <option value="{{ product_type | handle }}" selected>{{ product_type }}</option>
            {% else %}
            <option value="{{ product_type | handle }}">{{ product_type }}</option>
            {% endif %}
            {% endfor %}
            </select>
          {% endif %}
        </div>   
    
      </div>
  </div>

  {% comment %} <div class="col justify-content-center">
    <div class="clearfix filter">
    {% if collection.handle == 'collection' %}
      <p>Browse by tag:</p>
      <select class="coll-filter">
      <option value="">All</option>
      {% for tag in collection.all_tags %}
      {% if current_tags contains tag %}
      <option value="{{ tag | handle }}" selected>{{ tag }}</option>
      {% else %}
      <option value="{{ tag | handle }}">{{ tag }}</option>
      {% endif %}
      {% endfor %}
      </select>
    {% endif %}
    </div>         
  </div> {% endcomment %}

 <div class="row g-3 row-cols-xl-6 row-cols-lg-5 row-cols-md-3 row-cols-sm-2 row-cols- 1 py-5">

    {% for product in collection.products %}
      {% assign image = product.featured_media.preview_image %}
        <div class="col">
          <div class="card">
            {% if image != blank %}  
            <a href="{{ product.url }}"><img class="card-img-top" src="{{  image | img_url:'medium' }}" alt="{{ product.title }}"></a>
    
            {% else %}          
                {{ 'product-1' | placeholder_svg_tag: 'card-img-top' }}
    
            {% endif %}
    
            <div class="card-body">
                <h3><a href="{{ product.url }}">{{ product.title }}</a></h3>    
                <p>{{ product.price | money_without_trailing_zeros }}</p>            
            </div>        
          </div>
        </div>
        
      
     
      {% else %}
        <p>no matches</p>
      {% endfor %}
  
  </div>
  
  {% render 'pagination' , paginate: paginate %}
  {% endpaginate %}


</section>


{% comment %} <script>  

  var collFilters = jQuery('.coll-filter');
  collFilters.change(function() {
  var newTags = [];
  collFilters.each(function() { 
  if (jQuery(this).val()) {
  newTags.push(jQuery(this).val());
  }
  });
  if (newTags.length) {
  var query = newTags.join('+');
  window.location.href = jQuery('{{ 'tag' | link_to_tag: 'tag' }}').attr('href').replace('tag', query);
  } 
  else {
  {% if collection.handle %}
  window.location.href = '/collections/{{ collection.handle }}';
  {% elsif collection.products.first.type == collection.title %}
  window.location.href = '{{ collection.title | url_for_type }}';
  {% elsif collection.products.first.vendor == collection.title %}
  window.location.href = '{{ collection.title | url_for_vendor }}';
  {% endif %}
  }
  });
</script> {% endcomment %}
<script>  

  var collFilters2 = jQuery('#filter_by_type');
  collFilters2.change(function() {
  var newTags2 = [];
  collFilters2.each(function() { 
  if (jQuery(this).val()) {
  newTags2.push(jQuery(this).val());
  }
  });
  if (newTags2.length) {
  var query = newTags2.join('+');
  window.location.href = jQuery('{{ 'product_type' | link_to_tag: 'product_type' }}').attr('href').replace('product_type', query);
  } 
  else {
  {% if collection.handle %}
  window.location.href = '/collections/{{ collection.handle }}';
  {% elsif collection.products.first.type == collection.title %}
  window.location.href = '{{ collection.title | url_for_type }}';
  {% elsif collection.products.first.vendor == collection.title %}
  window.location.href = '{{ collection.title | url_for_vendor }}';
  {% endif %}
  }
  });
</script>
{% comment %}theme-check-enable{% endcomment %}
